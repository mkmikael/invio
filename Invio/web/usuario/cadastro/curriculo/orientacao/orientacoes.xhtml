<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
                template="/publico/template/templatePadrao.xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://java.sun.com/jsf/core">
    <h:outputScript name="script/locales.js" library="js" />

    <ui:define name="content">

        <h:form id="Orientacao" acceptcharset="ISO-8859-1" >  
            <p:panel header="Lista de Orientações">

                <p:messages showDetail="true" showSummary="true"/>  

                <p:panel header="Nova Orientação">  
                    <h:panelGrid columns="6" id="grid" cellspacing="4">  

                        <h:outputText value="Tipo de Orientação: *" />
                        <p:selectOneMenu id="tOrientacao" value="#{orientacaoBean.orientacao.tipoOrientacao}">  
                            <f:selectItem itemLabel="" itemValue="" />  
                            <f:selectItem itemLabel="Bolsista DTI (Orientação)" itemValue="1" />  
                            <f:selectItem itemLabel="Dissertação de Mestrado (Co-orientação)" itemValue="2" />  
                            <f:selectItem itemLabel="Dissertação de Mestrado (Orientação)" itemValue="3" />  
                            <f:selectItem itemLabel="Especialização (Orientação)" itemValue="4" />  
                            <f:selectItem itemLabel="Iniciação Científica (Orientação)" itemValue="5" />  
                            <f:selectItem itemLabel="TCC (Orientação)" itemValue="6" />  
                            <f:selectItem itemLabel="Tese de Doutorado (Co-orientação)" itemValue="7" />  
                            <f:selectItem itemLabel="Tese Doutorado (Orientação)" itemValue="8" /> 
                        </p:selectOneMenu>

                        <h:outputLabel value="Nome Bolsista : *"/> 
                        <p:inputText 
                            id="Bolsista"   
                            maxlength="100"
                            value="#{orientacaoBean.orientacao.aluno}" />  

                        <h:outputText value="Tipo de Bolsa: *" />
                        <p:selectOneMenu value="#{orientacaoBean.orientacao.tipoBolsa}">  
                            <f:selectItem itemLabel="" itemValue="" />  
                            <f:selectItem itemLabel="PIBIC/UFRA-AF" itemValue="UFRA-AF" />  
                            <f:selectItem itemLabel="PIBIC/UFRA" itemValue="UFRA" />  
                            <f:selectItem itemLabel="CNPq-AF" itemValue="CNPQ-AF" />  
                            <f:selectItem itemLabel="CNPq" itemValue="CNPQ" />  
                            <f:selectItem itemLabel="FAPESPA" itemValue="FAPESPA" />  
                            <f:selectItem itemLabel="CAPES" itemValue="CAPES" />  
                            <f:selectItem itemLabel="Outro" itemValue="Outro" />  
                        </p:selectOneMenu>

                        <h:outputText value="Período Inicial :" />
                        <p:calendar locale="pt_BR"
                                    showButtonPanel="true"
                                    value="#{orientacaoBean.orientacao.PInicial}" 
                                    navigator="true" 
                                    selectOtherMonths="true"
                                    pattern="MM/yyyy" 
                                    id="periodoInicial" /> 

                        <h:outputText value="Período Final: *"/>
                        <p:calendar 
                            value="#{orientacaoBean.orientacao.PFinal}" 
                            navigator="true" 
                            pattern="MM/yyyy" 
                            id="periodoFinal" />                        

                        <p:commandButton value="Limpar" type="reset"/>  
                        <p:commandButton 
                            id="btn_add" 
                            value="Adicionar"
                            ajax="false"
                            action="#{orientacaoBean.salvarOrientacao}"
                            update=":orientacoesTabela"/>

                    </h:panelGrid>  
                </p:panel>  

                <br/>

                <p:tabView>

                    <p:tab id="orientacoesTab1" title="Orientações Contabilizadas">


                        <p:dataTable 
                            id="orientacoesTabela" 
                            value="#{orientacaoBean.orientacoesAtuais}" 
                            var="orientacao"
                            emptyMessage="Sem registro para a exibição."
                            paginator="true" rows="10" 
                            rowsPerPageTemplate="20,40">

                            <!--                    <p:ajax 
                                                    event="rowEdit" 
                                                    listener="#{orientacaoBean.salvarEditarOrientacao(orientacao)}" 
                                                    update="orientacoesTabela" />  -->

                            <p:column headerText="Bolsista"
                                      style="max-width: 250px;min-width: 110px; 
                                      overflow: hidden;  max-height: 12px; 
                                      min-height: 12px; white-space: pre-line">
                                <h:outputLabel value="#{orientacao.aluno}"/> 
                            </p:column>

                            <p:column headerText="Período Inicial"
                                      style="max-width: 50px;min-width: 45px; 
                                      overflow: hidden;  max-height: 12px; 
                                      min-height: 12px; white-space: pre-line"> 
                                <h:outputText  value="#{orientacao.PInicial}">
                                    <f:convertDateTime pattern="MM/yyyy"/>
                                </h:outputText> 
                            </p:column>

                            <p:column headerText="Período Final"
                                      style="max-width: 80px;min-width: 55px; 
                                      overflow: hidden;  max-height: 12px; 
                                      min-height: 12px; white-space: pre-line"> 
                                <h:outputLabel value="#{orientacao.PFinal}">
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </h:outputLabel> 
                            </p:column>

                            <p:column headerText="Tipo de Orientação"
                                      style="max-width: 250px;min-width: 110px; 
                                      overflow: hidden;  max-height: 12px; 
                                      min-height: 12px; white-space: pre-line">
                                <h:outputLabel value="#{orientacaoBean.obterTipo(orientacao.tipoOrientacao)}"/> 
                            </p:column>

                            <p:column headerText="Tipo de Bolsa"
                                      style="max-width: 110px;min-width: 110px; 
                                      overflow: hidden;  max-height: 12px; 
                                      min-height: 12px; white-space: pre-line"> 
                                <h:outputLabel value="#{orientacao.tipoBolsa}"/> 
                            </p:column>

                            <p:column headerText="Pontuação"
                                      style="max-width: 70px;min-width: 30px; 
                                      overflow: hidden;  max-height: 12px; 
                                      min-height: 12px; white-space: pre-line">
                                <h:outputLabel value="#{orientacao.estrato}"/> 
                            </p:column>

                            <p:column headerText="Operação" style="max-width: 95px;min-width: 95px; 
                                      overflow: hidden;  max-height: 12px; 
                                      min-height: 12px; white-space: pre-line;
                                      text-align: center">  


                                <p:commandButton
                                    icon="ui-icon-arrowstop-1-n"
                                    title="Enviar Comprovante"
                                    onclick="PF('dlg1').show()"/>
                                
                                <p:commandButton title="Excluir"
                                                 icon="ui-icon-trash"
                                                 ajax="false"
                                                 action="/usuario/cadastro/curriculo/orientacao/excluirOrientacao.xhtml"
                                                 >
                                    <f:setPropertyActionListener 
                                        value="#{orientacao}" 
                                        target="#{orientacaoBean.orientacao}" />
                                </p:commandButton>  

                            </p:column>

                            <f:facet name="footer">
                                Total em orientações:
                                <h:outputLabel value="#{orientacaoBean.total}"/>
                            </f:facet>

                        </p:dataTable>  
                    </p:tab>

                    <p:tab id="orientacoesTab2" title="Orientações Arquivadas">
                        <p:dataTable 
                            id="orientacoesTabela2" 
                            value="#{orientacaoBean.orientacoesPassadas}" 
                            var="orientacao"
                            emptyMessage="Sem registro para a exibição."
                            paginator="true" rows="10" 
                            rowsPerPageTemplate="20,40">

                            <!--                    <p:ajax 
                                                    event="rowEdit" 
                                                    listener="#{orientacaoBean.salvarEditarOrientacao(orientacao)}" 
                                                    update="orientacoesTabela" />  -->

                            <p:column headerText="Bolsista"
                                      style="max-width: 250px;min-width: 110px; 
                                      overflow: hidden;  max-height: 12px; 
                                      min-height: 12px; white-space: pre-line">
                                <h:outputLabel value="#{orientacao.aluno}"/> 
                            </p:column>

                            <p:column headerText="Período Inicial"
                                      style="max-width: 50px;min-width: 45px; 
                                      overflow: hidden;  max-height: 12px; 
                                      min-height: 12px; white-space: pre-line"> 
                                <h:outputText  value="#{orientacao.PInicial}">
                                    <f:convertDateTime pattern="MM/yyyy"/>
                                </h:outputText> 
                            </p:column>

                            <p:column headerText="Período Final"
                                      style="max-width: 80px;min-width: 55px; 
                                      overflow: hidden;  max-height: 12px; 
                                      min-height: 12px; white-space: pre-line"> 
                                <h:outputLabel value="#{orientacao.PFinal}">
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </h:outputLabel> 
                            </p:column>

                            <p:column headerText="Tipo de Orientação"
                                      style="max-width: 250px;min-width: 110px; 
                                      overflow: hidden;  max-height: 12px; 
                                      min-height: 12px; white-space: pre-line">
                                <h:outputLabel value="#{orientacaoBean.obterTipo(orientacao.tipoOrientacao)}"/> 
                            </p:column>

                            <p:column headerText="Tipo de Bolsa"
                                      style="max-width: 110px;min-width: 110px; 
                                      overflow: hidden;  max-height: 12px; 
                                      min-height: 12px; white-space: pre-line"> 
                                <h:outputLabel value="#{orientacao.tipoBolsa}"/> 
                            </p:column>

                            <p:column headerText="Pontuação"
                                      style="max-width: 70px;min-width: 30px; 
                                      overflow: hidden;  max-height: 12px; 
                                      min-height: 12px; white-space: pre-line">
                                <h:outputLabel value="#{orientacao.estrato}"/> 
                            </p:column>

                            <p:column headerText="Operação" style="max-width: 95px;min-width: 95px; 
                                      overflow: hidden;  max-height: 12px; 
                                      min-height: 12px; white-space: pre-line">  
                                    <p:commandButton value="Excluir"
                                                     ajax="false"
                                                     icon="ui-icon-trash"
                                                     action="/usuario/cadastro/curriculo/orientacao/excluirOrientacao.xhtml"
                                                     >
                                        <f:setPropertyActionListener 
                                            value="#{orientacao}" 
                                            target="#{orientacaoBean.orientacao}" />
                                    </p:commandButton>
                            </p:column>
                        </p:dataTable>  

                    </p:tab>
                </p:tabView>

            </p:panel>
            <p:dialog header="Enviar Comprovante" widgetVar="dlg1" minHeight="40">
                <p:fileUpload 
                    fileUploadListener="#{curriculoBean.uploadActionPlano}"  
                    mode="advanced"  
                    label="Carregar Arquivo" 
                    update="enviado"
                    auto="true" 
                    sizeLimit="10000000"   
                    allowTypes="/(\.|\/)(jpe?g|pdf)$/"/>  
                <p:messages id="enviado" showSummary="true" showDetail="true"/>
            </p:dialog>
        </h:form>  

    </ui:define>

</ui:composition>
